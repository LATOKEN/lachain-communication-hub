package communication

import (
	"bufio"
	"bytes"
	"github.com/magiconair/properties/assert"
	"strings"
	"testing"
)

func TestCommunication(t *testing.T) {

	s := "546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024546546546545024"

	stream := strings.NewReader(s)
	buf := bytes.NewBufferString(s)

	rw := bufio.NewReadWriter(bufio.NewReader(stream), bufio.NewWriter(buf))

	res, err := ReadOnce(rw)
	if err != nil {
		panic(err)
	}
	assert.Equal(t, s, string(res))
}
